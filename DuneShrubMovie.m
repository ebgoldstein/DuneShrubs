function DuneShrubMovie(Domain,Steps,Type)

% Create and save movie frames of island domain over time
% Type: use 1 for Shrub Age, 2 for Percent Cover, 3 for Elevation

% Ian Reeves 19 Sep 18

if Type == 1
    aximin = 0;
    aximax = 10;
    BarLabel = 'Shrub Age (yr)';
    FrameType = 'AgeFrame';
%     Cmap = [1 1 1;1 1 1;1 1 1;1 1 1;1 1 1;0.23137255012989 0.176470592617989 0.796078443527222;0.245953127741814 0.195726424455643 0.82104754447937;0.260533720254898 0.214982256293297 0.846016585826874;0.275114297866821 0.234238088130951 0.870985686779022;0.272139996290207 0.269856184720993 0.895819962024689;0.269165724515915 0.305474281311035 0.920654237270355;0.266191422939301 0.341092377901077 0.945488572120667;0.263217151165009 0.376710474491119 0.970322847366333;0.260242849588394 0.412328571081161 0.995157122612;0.244033336639404 0.435833334922791 0.998833358287811;0.220642849802971 0.460257142782211 0.997285723686218;0.196333333849907 0.484719038009644 0.989152371883392;0.183404758572578 0.507371425628662 0.979795217514038;0.179921418428421 0.528638124465942 0.965907096862793;0.176438093185425 0.549904763698578 0.952019035816193;0.168742850422859 0.570261895656586 0.935871422290802;0.153999999165535 0.590200006961823 0.921800017356873;0.146011903882027 0.608914256095886 0.909545242786407;0.138023808598518 0.627628564834595 0.897290468215942;0.123752377927303 0.645028591156006 0.884787321090698;0.109480954706669 0.662428557872772 0.872284114360809;0.0952095240354538 0.679828584194183 0.859780967235565;0.0688714310526848 0.694771409034729 0.839357137680054;0.0296666659414768 0.708166658878326 0.81633335351944;0.00357142859138548 0.72026664018631 0.791700005531311;0.00665714265778661 0.731214284896851 0.766014277935028;0.0433285720646381 0.741095244884491 0.739409506320953;0.0963952392339706 0.75 0.712038099765778;0.140771433711052 0.758400022983551 0.684157133102417;0.171700000762939 0.766961932182312 0.655442833900452;0.193892866373062 0.775630950927734 0.623871445655823;0.216085717082024 0.784300029277802 0.592299997806549;0.246957138180733 0.791795253753662 0.55674284696579;0.290614277124405 0.797290503978729 0.518828570842743;0.345095902681351 0.794716358184814 0.476524502038956;0.399577528238297 0.7921422123909 0.434220403432846;0.454059153795242 0.789568066596985 0.391916334629059;0.50854080915451 0.786993861198425 0.349612236022949;0.563022434711456 0.78441971540451 0.307308167219162;0.617504060268402 0.781845569610596 0.265004068613052;0.671985685825348 0.779271423816681 0.222699999809265;0.724200010299683 0.769842863082886 0.191028565168381;0.773833334445953 0.759804785251617 0.164609521627426;0.820314288139343 0.74981427192688 0.153528571128845;0.863433361053467 0.740599989891052 0.159633338451385;0.903542876243591 0.733028590679169 0.177414283156395;0.939257144927979 0.728785693645477 0.209957137703896;0.972757160663605 0.729771435260773 0.239442855119705;0.995647609233856 0.743371427059174 0.237147614359856;0.989874601364136 0.767646014690399 0.223235711455345;0.984101593494415 0.79192066192627 0.209323808550835;0.978328585624695 0.816195249557495 0.195411905646324;0.97255551815033 0.840469837188721 0.181500002741814;0.966782510280609 0.864744484424591 0.167588099837303;0.961009502410889 0.889019072055817 0.153676196932793;0.963711082935333 0.912888884544373 0.137904763221741;0.966412723064423 0.936758756637573 0.122133336961269;0.969114303588867 0.960628569126129 0.106361903250217;0.976899981498718 0.983900010585785 0.0804999992251396];
    Cmap = [1 1 1;1 1 1;1 1 1;1 1 1;1 1 1;1 1 1;1 0 0;0.275114297866821 0.234238088130951 0.870985686779022;0.272635728120804 0.263919830322266 0.891680955886841;0.270157158374786 0.29360157251358 0.912376165390015;0.267678558826447 0.323283314704895 0.933071374893188;0.265199989080429 0.352965086698532 0.953766644001007;0.262721419334412 0.382646828889847 0.974461913108826;0.260242849588394 0.412328571081161 0.995157122612;0.244033336639404 0.435833334922791 0.998833358287811;0.220642849802971 0.460257142782211 0.997285723686218;0.196333333849907 0.484719038009644 0.989152371883392;0.183404758572578 0.507371425628662 0.979795217514038;0.178517460823059 0.52833491563797 0.965153932571411;0.173630148172379 0.549298405647278 0.950512707233429;0.168742850422859 0.570261895656586 0.935871422290802;0.153999999165535 0.590200006961823 0.921800017356873;0.146011903882027 0.608914256095886 0.909545242786407;0.138023808598518 0.627628564834595 0.897290468215942;0.123752377927303 0.645028591156006 0.884787321090698;0.109480954706669 0.662428557872772 0.872284114360809;0.0952095240354538 0.679828584194183 0.859780967235565;0.0688714310526848 0.694771409034729 0.839357137680054;0.0296666659414768 0.708166658878326 0.81633335351944;0.00357142859138548 0.72026664018631 0.791700005531311;0.00665714265778661 0.731214284896851 0.766014277935028;0.0433285720646381 0.741095244884491 0.739409506320953;0.0963952392339706 0.75 0.712038099765778;0.140771433711052 0.758400022983551 0.684157133102417;0.171700000762939 0.766961932182312 0.655442833900452;0.193892866373062 0.775630950927734 0.623871445655823;0.216085717082024 0.784300029277802 0.592299997806549;0.246957138180733 0.791795253753662 0.55674284696579;0.290614277124405 0.797290503978729 0.518828570842743;0.345095902681351 0.794716358184814 0.476524502038956;0.399577528238297 0.7921422123909 0.434220403432846;0.454059153795242 0.789568066596985 0.391916334629059;0.50854080915451 0.786993861198425 0.349612236022949;0.563022434711456 0.78441971540451 0.307308167219162;0.617504060268402 0.781845569610596 0.265004068613052;0.671985685825348 0.779271423816681 0.222699999809265;0.724200010299683 0.769842863082886 0.191028565168381;0.773833334445953 0.759804785251617 0.164609521627426;0.820314288139343 0.74981427192688 0.153528571128845;0.863433361053467 0.740599989891052 0.159633338451385;0.903542876243591 0.733028590679169 0.177414283156395;0.939257144927979 0.728785693645477 0.209957137703896;0.972757160663605 0.729771435260773 0.239442855119705;0.995647609233856 0.743371427059174 0.237147614359856;0.989874601364136 0.767646014690399 0.223235711455345;0.984101593494415 0.79192066192627 0.209323808550835;0.978328585624695 0.816195249557495 0.195411905646324;0.97255551815033 0.840469837188721 0.181500002741814;0.966782510280609 0.864744484424591 0.167588099837303;0.961009502410889 0.889019072055817 0.153676196932793;0.963711082935333 0.912888884544373 0.137904763221741;0.966412723064423 0.936758756637573 0.122133336961269;0.969114303588867 0.960628569126129 0.106361903250217;0.976899981498718 0.983900010585785 0.0804999992251396];
elseif Type == 2
    aximin = 0;
    aximax = 100;
    BarLabel = 'Shrub Percent Cover';
    FrameType = 'CoverFrame';
    Cmap = [0.823529422283173 0.788235306739807 0.662745118141174;0.833115458488464 0.801742911338806 0.667538166046143;0.842701554298401 0.81525057554245 0.672331154346466;0.852287590503693 0.828758180141449 0.677124202251434;0.861873626708984 0.842265784740448 0.681917250156403;0.871459722518921 0.855773448944092 0.686710238456726;0.881045758724213 0.869281053543091 0.691503286361694;0.890631794929504 0.88278865814209 0.696296334266663;0.900217890739441 0.896296322345734 0.701089322566986;0.909803926944733 0.909803926944733 0.705882370471954;0.895501732826233 0.913956165313721 0.698961973190308;0.881199538707733 0.918108403682709 0.692041516304016;0.866897344589233 0.922260701656342 0.685121119022369;0.852595150470734 0.92641294002533 0.678200721740723;0.838292956352234 0.930565178394318 0.671280324459076;0.823990762233734 0.934717416763306 0.664359867572784;0.809688568115234 0.938869655132294 0.657439470291138;0.795386373996735 0.943021893501282 0.650519073009491;0.78108423948288 0.947174191474915 0.643598616123199;0.76678204536438 0.951326429843903 0.636678218841553;0.75247985124588 0.955478668212891 0.629757821559906;0.73817765712738 0.959630906581879 0.622837364673615;0.723875463008881 0.963783144950867 0.615916967391968;0.709573268890381 0.967935383319855 0.608996570110321;0.695271074771881 0.972087681293488 0.602076172828674;0.680968880653381 0.976239919662476 0.595155715942383;0.666666686534882 0.980392158031464 0.588235318660736;0.658823549747467 0.972549021244049 0.580392181873322;0.650980412960052 0.964705884456635 0.572549045085907;0.643137276172638 0.95686274766922 0.564705908298492;0.635294139385223 0.949019610881805 0.556862771511078;0.627451002597809 0.941176474094391 0.549019634723663;0.619607865810394 0.933333337306976 0.541176497936249;0.61176472902298 0.925490200519562 0.533333361148834;0.603921592235565 0.917647063732147 0.52549022436142;0.596078455448151 0.909803926944733 0.517647087574005;0.588235318660736 0.901960790157318 0.509803950786591;0.578221321105957 0.887106657028198 0.491111129522324;0.568207323551178 0.872252583503723 0.472418338060379;0.558193325996399 0.857398450374603 0.453725516796112;0.548179268836975 0.842544376850128 0.435032695531845;0.538165271282196 0.827690243721008 0.416339904069901;0.528151273727417 0.812836110591888 0.397647082805634;0.518137276172638 0.797982037067413 0.378954261541367;0.508123278617859 0.783127903938293 0.360261470079422;0.49810928106308 0.768273830413818 0.341568648815155;0.488095253705978 0.753419697284698 0.322875827550888;0.478081256151199 0.738565564155579 0.304183036088943;0.46806725859642 0.723711490631104 0.285490214824677;0.458053261041641 0.708857357501984 0.26679739356041;0.44803923368454 0.694003283977509 0.248104587197304;0.438025236129761 0.679149150848389 0.229411780834198;0.417863011360168 0.655559897422791 0.210294127464294;0.397700756788254 0.631970703601837 0.191176488995552;0.377538532018661 0.608381450176239 0.172058835625648;0.357376307249069 0.584792256355286 0.152941182255745;0.337214082479477 0.561203002929688 0.133823543787003;0.317051827907562 0.537613809108734 0.114705890417099;0.29688960313797 0.514024555683136 0.095588244497776;0.276727378368378 0.49043533205986 0.0764705911278725;0.256565123796463 0.466846108436584 0.0573529452085495;0.236402899026871 0.443256884813309 0.0382352955639362;0.216240674257278 0.419667661190033 0.0191176477819681;0.196078434586525 0.396078437566757 0];
else
    temp = squeeze(Domain(Steps,:,:));
    aximin = 0;
    aximax = ceil(max(temp(:)));
    BarLabel = 'Island Elevation (m)';
    FrameType = 'ElevationFrame';
    Cmap = 'Parula';
end

for t = 1:Steps
    
    Tframe = squeeze(Domain(t,:,:));
    Tframe = rot90(Tframe,3);
    Tframe = fliplr(Tframe);
    figure(gcf);    
    imagesc(Tframe); figure(gcf);
    colormap(Cmap);
    set(gcf,'rend','painters','pos',[150,300,1500,150]); % Position and size of frame
    set(gca,'Ydir','normal')
    ylabel('Island Width');
    xlabel('Island Length');
    bar = colorbar;
    ylabel(bar,BarLabel,'Rotation', 270);
    caxis([aximin aximax]);
    time = strcat(['t = ',num2str(t),' yr']);
    annotation('textbox',[.13 0 .05 .15],'String',time,'FitBoxToText','off','HorizontalAlignment','center','VerticalAlignment','middle','FontSize',12,'BackgroundColor',[1 1 1],'EdgeColor',[0 0 0]);
    pmovie(t) = getframe;
    set(gcf, 'InvertHardCopy', 'off','PaperPositionMode','auto');
    outputfilename = ['C:/Reeves/DuneShrub/MovieFrames/' FrameType num2str(t)]; % Save frames  !!Hardwired to IRBR desktop computer!!
    print('-dpng',outputfilename)

end

% % Play movie
% movie(pmovie,1,3) % Plays 1 time, 2 fps
% save(['C:/Reeves/DuneShrub/MovieFrames/pmovie.mat'],'pmovie')


end

